<!DOCTYPE html>
<html>
<head>
  <title>Métodos Computacionais para Análise de Risco</title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Métodos Computacionais para Análise de Risco',
                        subtitle: '03 - Principais Funções e Operações',
                useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                        favIcon: '03-principais_funcoes_files/logo.png',
              },

      // Author information
      presenters: [
            {
        name:  'Prof.: Thais Paiva' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <script src="libs/header-attrs-2.13/header-attrs.js"></script>
  <link href="libs/ioslides-13.5.1/fonts/fonts.css" rel="stylesheet" />
  <link href="libs/ioslides-13.5.1/theme/css/default.css" rel="stylesheet" />
  <link href="libs/ioslides-13.5.1/theme/css/phone.css" rel="stylesheet" />
  <script src="libs/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
  <script src="libs/ioslides-13.5.1/js/prettify/prettify.js"></script>
  <script src="libs/ioslides-13.5.1/js/prettify/lang-r.js"></script>
  <script src="libs/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
  <script src="libs/ioslides-13.5.1/js/hammer.js"></script>
  <script src="libs/ioslides-13.5.1/js/slide-controller.js"></script>
  <script src="libs/ioslides-13.5.1/js/slide-deck.js"></script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    summary {
      display: list-item;
    }

    details > summary > p:only-child {
      display: inline;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }
/* https://github.com/ropensci/plotly/pull/524#issuecomment-468142578 */
slide:not(.current) .plotly.html-widget{
  display: block;
}

    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
        
    slides > slide:not(.nobackground):before {
      font-size: 12pt;
      content: "";
      position: absolute;
      bottom: 20px;
      left: 60px;
      background: url(03-principais_funcoes_files/logo.png) no-repeat 0 50%;
      -webkit-background-size: 30px 30px;
      -moz-background-size: 30px 30px;
      -o-background-size: 30px 30px;
      background-size: 30px 30px;
      padding-left: 40px;
      height: 30px;
      line-height: 1.9;
    }
  </style>

  <link rel="stylesheet" href="my.css" type="text/css" />

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <aside class="gdbar"><img src="03-principais_funcoes_files/logo.png"></aside>
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">08 de abril de 2022</p>
          </hgroup>
  </slide>

<slide class=""><hgroup><h2>Aula de Hoje</h2></hgroup><article  id="aula-de-hoje">

<ul>
<li><p>Classes de objetos: mais detalhes</p>

<ul>
<li><p>Caracteres e <em>Strings</em></p></li>
<li><p><em>Factors</em></p></li>
<li><p>Datas</p></li>
</ul></li>
<li><p>Expressões simbólicas no R</p></li>
<li><p>Funções no R</p>

<ul>
<li>Loops e Condições lógicas</li>
</ul></li>
</ul>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Caracteres e <em>Strings</em></h2></hgroup><article  id="caracteres-e-strings">

</article></slide><slide class=""><hgroup><h2>Caracteres e <em>Strings</em></h2></hgroup><article  id="caracteres-e-strings-1">

<ul>
<li><p>Várias variáveis que encontramos em bancos de dados podem ser <strong>caracteres</strong> ou <strong>sequências de caracteres</strong> (<em>strings</em>).</p></li>
<li><p>Por isso, temos uma classe específica para esse tipo de dado.</p></li>
</ul>

<pre class = 'prettyprint lang-r'>cidade = &quot;Belo Horizonte, MG&quot;
class(cidade)</pre>

<pre >## [1] &quot;character&quot;</pre>

<ul>
<li>Vamos ver algumas funções úteis para manipular esse tipo de variável.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Caracteres e <em>Strings</em></h2></hgroup><article  id="caracteres-e-strings-2">

<ul>
<li>Por exemplo, se quisermos contar o número de caracteres em um <em>string</em>:</li>
</ul>

<pre class = 'prettyprint lang-r'>nchar(cidade)</pre>

<pre >## [1] 18</pre>

<p><em>O espaço e a vírgula contam!</em></p>

<ul>
<li>Ou extrair uma determinada parte do objeto:</li>
</ul>

<pre class = 'prettyprint lang-r'>substr(cidade, start=1, stop=4)</pre>

<pre >## [1] &quot;Belo&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Caracteres e <em>Strings</em></h2></hgroup><article  id="caracteres-e-strings-3">

<ul>
<li>Para adicionar caracteres:</li>
</ul>

<pre class = 'prettyprint lang-r'>cidade = paste(cidade, &quot;, Brasil&quot;, sep=&quot;&quot;)
cidade</pre>

<pre >## [1] &quot;Belo Horizonte, MG, Brasil&quot;</pre>

<ul>
<li>Dividir o <em>string</em> em uma lista de objetos:</li>
</ul>

<pre class = 'prettyprint lang-r'>strsplit(cidade, split=&quot;, &quot;)    # retorna uma lista
## [[1]]
## [1] &quot;Belo Horizonte&quot; &quot;MG&quot;             &quot;Brasil&quot;

unlist(strsplit(cidade, split=&quot;, &quot;))[3]
## [1] &quot;Brasil&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Caracteres e <em>Strings</em></h2></hgroup><article  id="caracteres-e-strings-4">

<ul>
<li>E como estamos no R, é claro que podemos fazer isso usando <span class="red3">
<strong>vetores</strong></span>!</li>
</ul>

<pre class = 'prettyprint lang-r'>cidades = c(&quot;Belo Horizonte, MG&quot;, &quot;São Paulo, SP&quot;, &quot;Brasília, DF&quot;)
substr(cidades, nchar(cidades)-1, nchar(cidades))</pre>

<pre >## [1] &quot;MG&quot; &quot;SP&quot; &quot;DF&quot;</pre>

<pre class = 'prettyprint lang-r'>unlist(strsplit(cidades, &quot;, &quot;))[seq(2,6,by=2)]</pre>

<pre >## [1] &quot;MG&quot; &quot;SP&quot; &quot;DF&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Caracteres e <em>Strings</em></h2></hgroup><article  id="caracteres-e-strings-5">

<ul>
<li><p>Em aplicações da Atuária, muitas vezes teremos <span class="red3">
caracteres</span> e <span class="red3">
<em>strings</em></span> como <em>input</em> nos nossos códigos e modelos.</p></li>
<li><p>Mas também podemos precisar salvar <span class="red3">
caracteres</span> como <strong>saída</strong> de uma função.</p></li>
</ul>

<pre class = 'prettyprint lang-r'>n_cid = length(cidades)
cat(&quot;Número de cidades: &quot;,n_cid)</pre>

<pre >## Número de cidades:  3</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2><em>Factors</em></h2></hgroup><article  id="factors">

</article></slide><slide class=""><hgroup><h2>Variáveis Categóricas</h2></hgroup><article  id="variáveis-categóricas">

<ul>
<li><p>Em vários modelos estatísticos, informações armazenadas como caracteres podem ser incluídas como <span class="red3">
<strong>variáveis categóricas</strong></span>.</p></li>
<li><p>No R, podemos usar objetos da classe <code>factor</code>.</p></li>
</ul>

<pre class = 'prettyprint lang-r'>x = c( rep( letters[1:2], each=2), letters[3] )
x</pre>

<pre >## [1] &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;c&quot;</pre>

<pre class = 'prettyprint lang-r'>x = factor(x)
x</pre>

<pre >## [1] a a b b c
## Levels: a b c</pre>

</article></slide><slide class=""><hgroup><h2><em>Factors</em></h2></hgroup><article  id="factors-1">

<ul>
<li><em>Factors</em> são observações rotuladas de acordo com um conjunto pré-estabelecido de <strong>categorias</strong>.</li>
</ul>

<pre class = 'prettyprint lang-r'>unclass(x)
## [1] 1 1 2 2 3
## attr(,&quot;levels&quot;)
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</pre>

<ul>
<li>Podemos mudar os rótulos facilmente:</li>
</ul>

<pre class = 'prettyprint lang-r'>x = factor(x, labels=c(&quot;Ativo&quot;, &quot;Aposentado&quot;, &quot;Pensionista&quot;))
x
## [1] Ativo       Ativo       Aposentado  Aposentado  Pensionista
## Levels: Ativo Aposentado Pensionista</pre>

</article></slide><slide class=""><hgroup><h2><em>Factors</em></h2></hgroup><article  id="factors-2">

<ul>
<li><p>Se usarmos a variável <code>x</code> como covariável em um modelo de regressão, a categoria Ativo será a <strong>categoria de referência</strong>.</p></li>
<li><p>Para alterar a categoria de referência:</p></li>
</ul>

<pre class = 'prettyprint lang-r'>relevel(x, &quot;Aposentado&quot;)
## [1] Ativo       Ativo       Aposentado  Aposentado  Pensionista
## Levels: Aposentado Ativo Pensionista</pre>

<ul>
<li>A variável categórica também pode ser <strong>ordenada</strong>:</li>
</ul>

<pre class = 'prettyprint lang-r'>factor(x, ordered=T)
## [1] Ativo       Ativo       Aposentado  Aposentado  Pensionista
## Levels: Ativo &lt; Aposentado &lt; Pensionista</pre>

</article></slide><slide class=""><hgroup><h2><em>Factors</em></h2></hgroup><article  id="factors-3">

<ul>
<li>Para criar matriz com variáveis <em>dummy</em> a partir das categorias:</li>
</ul>

<pre class = 'prettyprint lang-r'>model.matrix(~0+x)</pre>

<pre >##   xAtivo xAposentado xPensionista
## 1      1           0            0
## 2      1           0            0
## 3      0           1            0
## 4      0           1            0
## 5      0           0            1
## attr(,&quot;assign&quot;)
## [1] 1 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$x
## [1] &quot;contr.treatment&quot;</pre>

</article></slide><slide class=""><hgroup><h2><em>Factors</em></h2></hgroup><article  id="factors-4">

<ul>
<li>Outra maneira de criar <strong>variáveis categóricas</strong>:</li>
</ul>

<pre class = 'prettyprint lang-r'>set.seed(1)
U = runif(10)
U</pre>

<pre >##  [1] 0.26550866 0.37212390 0.57285336 0.90820779 0.20168193 0.89838968
##  [7] 0.94467527 0.66079779 0.62911404 0.06178627</pre>

<pre class = 'prettyprint lang-r'>cut(U, breaks=3, labels=c(&quot;S&quot;,&quot;M&quot;,&quot;L&quot;))</pre>

<pre >##  [1] S M M L S L L L M S
## Levels: S M L</pre>

</article></slide><slide class=""><hgroup><h2><em>Factors</em></h2></hgroup><article  id="factors-5">

<ul>
<li>Podemos fixar também os limites:</li>
</ul>

<pre class = 'prettyprint lang-r'>x = cut(U, breaks=c(0,.3,.8,1), labels=c(&quot;S&quot;,&quot;M&quot;,&quot;L&quot;))
x</pre>

<pre >##  [1] S M M L S L L M M S
## Levels: S M L</pre>

<ul>
<li>E para acessar a frequência das categorias:</li>
</ul>

<pre class = 'prettyprint lang-r'>table(x)</pre>

<pre >## x
## S M L 
## 3 4 3</pre>

</article></slide><slide class=""><hgroup><h2><em>Factors</em></h2></hgroup><article  id="factors-6">

<ul>
<li>Também podemos gerar <strong>fatores</strong> com a função <code>gl</code>:</li>
</ul>

<pre class = 'prettyprint lang-r'>gl(n=3, k=2, labels=c(&quot;S&quot;,&quot;M&quot;,&quot;L&quot;), ordered=T)</pre>

<pre >## [1] S S M M L L
## Levels: S &lt; M &lt; L</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Datas</h2></hgroup><article  id="datas">

</article></slide><slide class=""><hgroup><h2>Datas</h2></hgroup><article  id="datas-1">

<ul>
<li><p><span class="red3">
<strong>Datas</strong></span> no R podem estar armazenadas em objetos da classe <code>POSIXlt</code> ou <code>POSIXct</code>, ou na classe <code>Date</code>.</p></li>
<li><p>Existem algumas funções para criar e manipular <span class="red3">
<strong>datas</strong></span> no R.</p></li>
</ul>

<pre class = 'prettyprint lang-r'>datas = as.Date(c(&quot;16/10/12&quot;, &quot;19/11/12&quot;), format=&quot;%d/%m/%y&quot;)
class(datas)</pre>

<pre >## [1] &quot;Date&quot;</pre>

<pre class = 'prettyprint lang-r'>datas</pre>

<pre >## [1] &quot;2012-10-16&quot; &quot;2012-11-19&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Datas</h2></hgroup><article  id="datas-2">

<ul>
<li>Diferença entre datas:</li>
</ul>

<pre class = 'prettyprint lang-r'>diff(datas)</pre>

<pre >## Time difference of 34 days</pre>

<pre class = 'prettyprint lang-r'>difftime(datas[2], datas[1], units=&quot;weeks&quot;)</pre>

<pre >## Time difference of 4.857143 weeks</pre>

</article></slide><slide class=""><hgroup><h2>Datas</h2></hgroup><article  id="datas-3">

<ul>
<li>Algumas funções que já conhecemos irão funcionar diferentemente para objetos do tipo <code>Date</code>.</li>
</ul>

<pre class = 'prettyprint lang-r'>seq.datas = seq(from=datas[1], to=datas[2], by=7)
seq.datas</pre>

<pre >## [1] &quot;2012-10-16&quot; &quot;2012-10-23&quot; &quot;2012-10-30&quot; &quot;2012-11-06&quot; &quot;2012-11-13&quot;</pre>

<ul>
<li>E podemos alterar o formato das datas:</li>
</ul>

<pre class = 'prettyprint lang-r'>format(seq.datas, &quot;%b&quot;)     # mês em formato abreviado</pre>

<pre >## [1] &quot;out&quot; &quot;out&quot; &quot;out&quot; &quot;nov&quot; &quot;nov&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Datas</h2></hgroup><article  id="datas-4">

<ul>
<li>Para saber o dia da semana ou o mês:</li>
</ul>

<pre class = 'prettyprint lang-r'>weekdays(seq.datas)</pre>

<pre >## [1] &quot;terça-feira&quot; &quot;terça-feira&quot; &quot;terça-feira&quot; &quot;terça-feira&quot; &quot;terça-feira&quot;</pre>

<pre class = 'prettyprint lang-r'>weekdays(datas[1]+1:4)</pre>

<pre >## [1] &quot;quarta-feira&quot; &quot;quinta-feira&quot; &quot;sexta-feira&quot;  &quot;sábado&quot;</pre>

<pre class = 'prettyprint lang-r'>months(seq.datas)</pre>

<pre >## [1] &quot;outubro&quot;  &quot;outubro&quot;  &quot;outubro&quot;  &quot;novembro&quot; &quot;novembro&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Datas</h2></hgroup><article  id="datas-5">

<ul>
<li>Para extrair o dia do mês ou o ano:</li>
</ul>

<pre class = 'prettyprint lang-r'>as.POSIXct(seq.datas)</pre>

<pre >## [1] &quot;2012-10-15 21:00:00 -03&quot; &quot;2012-10-22 22:00:00 -02&quot;
## [3] &quot;2012-10-29 22:00:00 -02&quot; &quot;2012-11-05 22:00:00 -02&quot;
## [5] &quot;2012-11-12 22:00:00 -02&quot;</pre>

<pre class = 'prettyprint lang-r'>substr( as.POSIXct(seq.datas), start=1, stop=4 )</pre>

<pre >## [1] &quot;2012&quot; &quot;2012&quot; &quot;2012&quot; &quot;2012&quot; &quot;2012&quot;</pre>

<pre class = 'prettyprint lang-r'>strftime(seq.datas ,&quot;%Y&quot;)  # mais rápido</pre>

<pre >## [1] &quot;2012&quot; &quot;2012&quot; &quot;2012&quot; &quot;2012&quot; &quot;2012&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Datas</h2></hgroup><article  id="datas-6">

<ul>
<li>Os dias das semana e os meses serão impressos de acordo com a linguagem que o R está usando.</li>
</ul>

<pre class = 'prettyprint lang-r'>temp = Sys.setlocale(&quot;LC_TIME&quot;)
temp</pre>

<pre >## [1] &quot;Portuguese_Brazil.1252&quot;</pre>

<ul>
<li>Para mudar para inglês, por exemplo:</li>
</ul>

<pre class = 'prettyprint lang-r'>Sys.setlocale(&quot;LC_TIME&quot;, &quot;english&quot; )  # CUIDADO!</pre>

<pre >## [1] &quot;English_United States.1252&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Datas</h2></hgroup><article  id="datas-7">

<pre class = 'prettyprint lang-r'>weekdays(seq.datas)</pre>

<pre >## [1] &quot;Tuesday&quot; &quot;Tuesday&quot; &quot;Tuesday&quot; &quot;Tuesday&quot; &quot;Tuesday&quot;</pre>

<pre class = 'prettyprint lang-r'>months(seq.datas)</pre>

<pre >## [1] &quot;October&quot;  &quot;October&quot;  &quot;October&quot;  &quot;November&quot; &quot;November&quot;</pre>

<pre class = 'prettyprint lang-r'>Sys.setlocale(&quot;LC_TIME&quot;, temp)  # voltar para a configuração original</pre>

<pre >## [1] &quot;Portuguese_Brazil.1252&quot;</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Expressões Simbólicas</h2></hgroup><article  id="expressões-simbólicas">

</article></slide><slide class=""><hgroup><h2>Expressões Simbólicas</h2></hgroup><article  id="expressões-simbólicas-1">

<ul>
<li><p>Em alguns casos, precisamos escrever expressões simbólicas no R usando notação específica.</p></li>
<li><p>Por exemplo, ao ajustar uma <strong>regressão</strong> precisamos especificar a <code>formula</code>.</p></li>
<li><p>Ao ajustar uma regressão com o código <code>lm(y ~ x1 + x2 + x3)</code>, estamos considerando o modelo:</p></li>
</ul>

<p>\[Y_i = \beta_0 + \beta_1 \, X_{1,i} + \beta_2 \, X_{2,i} + \beta_3 \, X_{3,i} + \epsilon_i \]</p>

</article></slide><slide class=""><hgroup><h2>Expressões Simbólicas</h2></hgroup><article  id="expressões-simbólicas-2">

<ul>
<li><p>Em uma fórmula, o símbolo <code>+</code> significa <span class="red3">
<strong>inclusão</strong></span> (e não adição), e o símbolo <code>-</code> significa <strong>exclusão</strong>.</p></li>
<li><p>Se quisermos ajustar um modelo com as covariáveis \(X_1\) e \((X_2 + X_3)\):</p></li>
</ul>

<pre class = 'prettyprint lang-r'>lm(y ~ x1 + I(x2+x3) )</pre>

<ul>
<li>Para incluir a <strong>interação</strong> entre variáveis <span class="red3">
categóricas</span> \(X_1\) e \(X_2\), podemos usar as expressões <code>x1:x2</code> ou <code>x1*x2</code>.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Expressões Simbólicas - Exemplo</h2></hgroup><article  id="expressões-simbólicas---exemplo">

<!--{.smaller}-->

<ul>
<li>Primeiro vamos criar um banco de dados simples:</li>
</ul>

<pre class = 'prettyprint lang-r'>
## Exemplo expressões simbólicas
set.seed(123)
df = data.frame( Y=rnorm(50), X1=as.factor(sample(LETTERS[1:4],size=50,replace=TRUE)), 
                 X2=as.factor(sample(1:3,size=50,replace=TRUE)) )
tail(df)
##              Y X1 X2
## 45  1.20796200  B  2
## 46 -1.12310858  B  1
## 47 -0.40288484  B  2
## 48 -0.46665535  C  3
## 49  0.77996512  D  3
## 50 -0.08336907  B  1</pre>

<p><span class="green3">
<strong>Exercício:</strong></span> Verifique a distribuição das variáveis <code>Y</code>, <code>X1</code> e <code>X2</code> geradas acima (estatísticas descritivas, histograma, tabela de frequência).</p>

</article></slide><slide class=""><hgroup><h2>Expressões Simbólicas</h2></hgroup><article  id="expressões-simbólicas-3">

<ul>
<li>Vamos ajustar o modelo de regressão mais básico:</li>
</ul>

<pre class = 'prettyprint lang-r'>reg = lm( Y ~ X1 + X2, data=df)
model.matrix(reg)[45:50,]</pre>

<pre >##    (Intercept) X1B X1C X1D X22 X23
## 45           1   1   0   0   1   0
## 46           1   1   0   0   0   0
## 47           1   1   0   0   1   0
## 48           1   0   1   0   0   1
## 49           1   0   0   1   0   1
## 50           1   1   0   0   0   0</pre>

</article></slide><slide class=""><hgroup><h2>Expressões Simbólicas</h2></hgroup><article  id="expressões-simbólicas-4" class="smaller">

<ul>
<li>E se adicionarmos <code>X1:X2</code> no modelo?</li>
</ul>

<pre class = 'prettyprint lang-r'>reg = lm( Y ~ X1 + X2 + X1:X2, data=df)
model.matrix(reg)[45:50,]</pre>

<pre >##    (Intercept) X1B X1C X1D X22 X23 X1B:X22 X1C:X22 X1D:X22 X1B:X23 X1C:X23
## 45           1   1   0   0   1   0       1       0       0       0       0
## 46           1   1   0   0   0   0       0       0       0       0       0
## 47           1   1   0   0   1   0       1       0       0       0       0
## 48           1   0   1   0   0   1       0       0       0       0       1
## 49           1   0   0   1   0   1       0       0       0       0       0
## 50           1   1   0   0   0   0       0       0       0       0       0
##    X1D:X23
## 45       0
## 46       0
## 47       0
## 48       0
## 49       1
## 50       0</pre>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Funções no R</h2></hgroup><article  id="funções-no-r">

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-1">

<ul>
<li><p>Como o R é <em>open-source</em>, podemos ver o código fonte de todas as funções.</p></li>
<li><p>Por exemplo, a função <code>factorial</code> para computar o fatorial de um número:</p></li>
</ul>

<pre class = 'prettyprint lang-r'>factorial
## function (x) 
## gamma(x + 1)
## &lt;bytecode: 0x0000000015b3b288&gt;
## &lt;environment: namespace:base&gt;</pre>

<pre class = 'prettyprint lang-r'>gamma
## function (x)  .Primitive(&quot;gamma&quot;)</pre>

<p><code>Primitive</code> é uma função internamente implementada.</p>

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-2">

<ul>
<li>Funções estatísticas básicas já estão implementadas no R, como <code>sum()</code>, <code>mean()</code>, <code>var()</code>, <code>sd()</code>.</li>
</ul>

<pre class = 'prettyprint lang-r'>x = c(1,4,6,6,10,5)
var(x)</pre>

<pre >## [1] 8.666667</pre>

<pre class = 'prettyprint lang-r'>sum( (x-mean(x))^2 ) / (length(x) - 1)</pre>

<pre >## [1] 8.666667</pre>

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-3">

<ul>
<li>Essas funções também funcionam para matrizes.</li>
</ul>

<pre class = 'prettyprint lang-r'>m = matrix(x,3,2)
m</pre>

<pre >##      [,1] [,2]
## [1,]    1    6
## [2,]    4   10
## [3,]    6    5</pre>

<pre class = 'prettyprint lang-r'>mean(m)</pre>

<pre >## [1] 5.333333</pre>

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-4">

<ul>
<li>Para calcular média por linha ou coluna, usar a função <code>apply()</code>:</li>
</ul>

<pre class = 'prettyprint lang-r'>apply(m, MARGIN=1, FUN=mean) # por linha
## [1] 3.5 7.0 5.5

apply(m, MARGIN=2, FUN=mean) # por coluna
## [1] 3.666667 7.000000</pre>

<ul>
<li>Para calcular soma por linha ou coluna, as funções <code>rowSums()</code> e <code>colSums()</code> podem ser mais rápidas que a função <code>apply</code>.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-5" class="smaller">

<!-- <div class="columns-2"> -->

<ul>
<li>Variações da função <code>apply</code>:</li>
</ul>

<pre class = 'prettyprint lang-r'>g = c(&quot;M&quot;,&quot;F&quot;,&quot;F&quot;,&quot;M&quot;,&quot;M&quot;,&quot;M&quot;)
base = data.frame(x,g)
base
##    x g
## 1  1 M
## 2  4 F
## 3  6 F
## 4  6 M
## 5 10 M
## 6  5 M</pre>

<pre class = 'prettyprint lang-r'>tapply(x, g, mean) # calcula média de acordo com as categorias da var. g</pre>

<pre >##   F   M 
## 5.0 5.5</pre>

</div>

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-6">

<ul>
<li>Tabela de Contingência 2x2:</li>
</ul>

<pre class = 'prettyprint lang-r'>base$status = c(&quot;Ativo&quot;, &quot;Ativo&quot;, &quot;Aposentado&quot;, &quot;Pensionista&quot;, &quot;Pensionista&quot;, &quot;Ativo&quot;)
table(base$g, base$status)
##    
##     Aposentado Ativo Pensionista
##   F          1     1           0
##   M          0     2           2</pre>

<pre class = 'prettyprint lang-r'>addmargins( table(base$g, base$status) )
##      
##       Aposentado Ativo Pensionista Sum
##   F            1     1           0   2
##   M            0     2           2   4
##   Sum          1     3           2   6</pre>

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-7" class="build">

<ul>
<li>Vimos várias funções no R para fazer diversos cálculos (e nem falamos de funções de pacotes!).</li>
</ul>

<p><em>Como lembrar de tantos detalhes? O que cada argumento significa?</em></p>

<ul>
<li>Consultar a <strong>página de ajuda</strong> de cada função! O <code>help</code> contém uma descrição da função, detalhes sobre os argumentos, o que a função retorna, exemplos…</li>
</ul>

<pre class = 'prettyprint lang-r'>?quantile</pre>

<ul>
<li>O RStudio também pode ajudar com alguns argumentos com o recurso de auto-completar (tecla <code>Tab</code>).</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Funções no R</h2></hgroup><article  id="funções-no-r-8">

<ul>
<li><p>Mas pode ser que não tenha uma função que faça <strong>exatamente</strong> o que precisamos. Para esses cálculos, precisamos escrever nossas <span class="blue3">
próprias funções</span>.</p></li>
<li><p>Antes, vamos ver alguns comandos interessantes para criar <em>loops</em> e repetições de cálculos.</p></li>
<li><p>Computadores são excelentes para repetir uma tarefa por um número determinado de vezes ou até que uma condição seja atingida. Isso pode ser feito com os comandos <code>for()</code> e <code>while()</code>.</p></li>
</ul>

</article></slide><slide class=""><hgroup><h2><em>Loops</em></h2></hgroup><article  id="loops">

<ul>
<li><p>O comando <code>for()</code> executa uma série de comandos (que estão entre as chaves <code>{ }</code>) para uma variável em uma determinada sequência.</p></li>
<li><p>O <em>loop</em> <code>for( i in 1:4 ){ ... }</code> irá executar os comandos em <code>{...}</code> quatro vezes, variando a variável <code>i</code> que irá assumir os valores 1, 2, 3, 4.</p></li>
</ul>

<ul class = 'build'>
<li>O comando <code>while()</code> executa os comandos (também entre chaves <code>{ }</code>) até que uma condição não seja mais verdadeira.</li>
</ul>

<ul class = 'build'>
<li>O <em>loop</em> <code>while(i&lt;5){ ...; i=i+1 }</code> irá executar os comandos em <code>{...}</code>, incluindo <code>i=i+1</code> até que a condição <code>i&lt;5</code> não seja mais verdadeira.</li>
</ul>

</article></slide><slide class=""><hgroup><h2><em>Loops</em></h2></hgroup><article  id="loops-1">

<ul>
<li><p>Por exemplo, vamos gerar um processo de Poisson, isto é, uma sequência no tempo de observações independentes que tem as seguintes propriedades:</p>

<ul>
<li><p>o número de pontos tem distribuição de Poisson com intensidade \(\lambda\);</p></li>
<li><p>o tempo entre as ocorrências/chegadas dos pontos tem distribuição exponencial com parâmetro \(\lambda\).</p></li>
</ul></li>
<li><p>Suponha que queremos gerar os tempos até as ocorrências até que o tempo total seja igual a 10. Vamos assumir \(\lambda=1\).</p></li>
</ul>

</article></slide><slide class=""><hgroup><h2><em>Loops</em> </h2><h3> Exemplo: Processo de Poisson</h3></hgroup><article  id="loops-exemplo-processo-de-poisson">

<pre class = 'prettyprint lang-r'># loop - Exemplo Processo de Poisson
T = NULL
while( sum(T) &lt;= 10 ){
  T = c( T, rexp(1) )
}
T
## [1] 0.37275016 3.46359489 1.27402772 1.08148515 0.29695916 0.08416073 2.95340092
## [8] 1.96825225</pre>

<pre class = 'prettyprint lang-r'>cumsum(T)
## [1]  0.3727502  3.8363451  5.1103728  6.1918579  6.4888171  6.5729778  9.5263787
## [8] 11.4946310</pre>

</article></slide><slide class=""><hgroup><h2><em>Loops</em></h2></hgroup><article  id="loops-2">

<ul>
<li><p>Cuidado ao usar <code>while()</code>! O <em>loop</em> precisa estar bem especificado, ou você pode acabar criando um <em>loop</em> infinito.</p></li>
<li><p><em>Loops</em> podem ser dispendiosos e ineficientes! Confira se o cálculo que você quer fazer não pode ser feito com outra função, como <code>apply()</code>.</p></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Condições lógicas</h2></hgroup><article  id="condições-lógicas">

<ul>
<li>Podemos fazer operações que dependem da avaliação de uma expressão lógica.</li>
</ul>

<!-- <div class="columns-2"> -->

<pre class = 'prettyprint lang-r'># Condições lógicas
set.seed(1)
u = runif(1)
u
## [1] 0.2655087

if(u&gt; 0.5){
  (&quot;maior que 50%&quot;)
}else{
  (&quot;menor que 50%&quot;)
}
## [1] &quot;menor que 50%&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Condições lógicas</h2></hgroup><article  id="condições-lógicas-1">

<ul>
<li>Podemos fazer operações que dependem da avaliação de uma expressão lógica.</li>
</ul>

<pre class = 'prettyprint lang-r'>ifelse( u&gt;0.5, (&quot;maior que 50%&quot;), (&quot;menor que 50%&quot;)  )</pre>

<pre >## [1] &quot;menor que 50%&quot;</pre>

<ul>
<li>A diferença é que <code>ifelse()</code> é vetorizável, e o <code>if()</code> não.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Condições lógicas</h2></hgroup><article  id="condições-lógicas-2">

<pre class = 'prettyprint lang-r'>u = runif(3)
u</pre>

<pre >## [1] 0.3721239 0.5728534 0.9082078</pre>

<pre class = 'prettyprint lang-r'>if(u&gt; 0.5){
  (&quot;maior que 50%&quot;)
}else{
  (&quot;menor que 50%&quot;)
}</pre>

<pre >## Warning in if (u &gt; 0.5) {: a condição tem comprimento &gt; 1 e somente o primeiro
## elemento será usado</pre>

<pre >## [1] &quot;menor que 50%&quot;</pre>

</article></slide><slide class=""><hgroup><h2>Condições lógicas</h2></hgroup><article  id="condições-lógicas-3">

<ul>
<li>A diferença é que <code>ifelse()</code> é vetorizável, e o <code>if()</code> não.</li>
</ul>

<pre class = 'prettyprint lang-r'>ifelse( u&gt;0.5, (&quot;maior que 50%&quot;), (&quot;menor que 50%&quot;) )</pre>

<pre >## [1] &quot;menor que 50%&quot; &quot;maior que 50%&quot; &quot;maior que 50%&quot;</pre></article></slide>


  <slide class="backdrop"></slide>

</slides>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
